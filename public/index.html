<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>HeartWins ¬∑ –ö–æ–ª–µ—Å–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
<canvas id="heartwins"></canvas>

<!-- –í–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫ HEARTWINS -->
<div class="hw-label">HEARTWINS</div>

<!-- –ü–æ–¥–ø–∏—Å—å –∞–≤—Ç–æ—Ä–∞ -->
<div class="hw-signature">Lyoubov Touinova‚Ñ¢</div>

<!-- UI-–æ–±–æ–ª–æ—á–∫–∞ –ø–æ–≤–µ—Ä—Ö –æ–±–ª–∞–∫–∞ —Ç–æ—á–µ–∫ -->
<div class="ui-shell">
  <header class="app-header">
    <div class="brand">
      <div class="brand-logo">
        <span>‚ù§</span>
      </div>
      <div class="brand-text">
        <div class="brand-title">HeartWins</div>
        <div class="brand-subtitle">awareness protocol</div>
      </div>
    </div>
    <div class="header-right">
      <span class="header-pill">wheel ¬∑ karma ¬∑ quiz</span>
      <button id="logoutBtn" class="btn ghost small" style="display:none;">–í—ã–π—Ç–∏</button>
    </div>
  </header>

  <main class="app-main">
    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
    <section id="authSection" class="panel auth-panel">
      <h1>–ö–æ–ª–µ—Å–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏</h1>
      <p class="muted">
        –í–æ–π–¥–∏, —á—Ç–æ–±—ã –∫–æ–ø–∏—Ç—å –∫–∞—Ä–º—É –∏ —Ç–æ–∫–µ–Ω—ã –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏.
      </p>

      <form id="loginForm" class="form">
        <label class="field-label" for="email">–≠–ª. –ø–æ—á—Ç–∞</label>
        <input id="email" type="email" class="field-input" placeholder="you@example.com" required>

        <label class="field-label" for="password">–ü–∞—Ä–æ–ª—å</label>
        <input id="password" type="password" class="field-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>

        <div class="form-row">
          <button type="submit" class="btn primary">–í–æ–π—Ç–∏ / –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        </div>
        <p class="small muted">
          –ü—Ä–∏ –ø–µ—Ä–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º—ã –ø—Ä–∏—à–ª—ë–º –ø–∏—Å—å–º–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
        </p>
      </form>
    </section>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω -->
    <section id="mainSection" class="panel main-panel" style="display:none;">
      <div class="main-grid">
        <div class="column">
          <div class="panel-card">
            <div class="panel-card-header">
              <div>
                <h2 id="profileGreeting">–ü—Ä–∏–≤–µ—Ç!</h2>
                <div id="profileEmail" class="muted small"></div>
              </div>
            </div>

            <div class="stats-row">
              <div class="stat-chip">
                <div class="stat-label">–ö–∞—Ä–º–∞</div>
                <div id="statKarma" class="stat-value">0</div>
              </div>
              <div class="stat-chip">
                <div class="stat-label">–û—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å</div>
                <div id="statAwareness" class="stat-value">0</div>
              </div>
              <div class="stat-chip">
                <div class="stat-label">–í–µ—Ä–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                <div id="statQuiz" class="stat-value">0</div>
              </div>
            </div>

            <div class="clicker">
              <div class="clicker-top">
                <div class="clicker-label">–ö–ª–∏–∫–µ—Ä –∫–∞—Ä–º—ã</div>
                <div class="clicker-sub">–û–¥–∏–Ω –∫–ª–∏–∫ ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–π –∂–µ—Å—Ç –≤–Ω–∏–º–∞–Ω–∏—è.</div>
              </div>
              <button id="karmaClickBtn" class="clicker-btn">
                üëÜ –ö–ª–∏–∫-–∫–∞—Ä–º–∞<br><span>+1 –∫–∞—Ä–º–∞</span>
              </button>
            </div>
          </div>
        </div>

        <div class="column">
          <div class="panel-card">
            <h2>üé° –ö–æ–ª–µ—Å–æ</h2>
            <p class="muted small">
              –°–ø–∏–Ω ‚Äî –∏ —Å–º–æ—Ç—Ä–∏, –∫—É–¥–∞ —Ç–µ—á—ë—Ç —Ç–≤–æ—è –∫–∞—Ä–º–∞.
            </p>

            <div class="wheel-layout">
              <div class="wheel-wrap">
                <div class="wheel" id="wheelVisual">
                  <div class="wheel-pointer"></div>
                  <div class="wheel-center">
                    –í–¥–æ—Ö<br>–í—ã–¥–æ—Ö<br><span>–Ω–∞–±–ª—é–¥–∞–π</span>
                  </div>
                </div>
              </div>
              <div class="wheel-side">
                <button id="spinBtn" class="btn primary full">üîÑ –ö—Ä—É—Ç–∏—Ç—å –∫–æ–ª–µ—Å–æ</button>
                <div id="wheelResult" class="wheel-result"></div>
                <div id="sutraBox" class="sutra-box">
                  –°—É—Ç—Ä–∞ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ —Å–ø–∏–Ω–∞.
                </div>
              </div>
            </div>
          </div>

          <div class="panel-card">
            <h2>üìö –í–∏–∫—Ç–æ—Ä–∏–Ω–∞</h2>
            <p class="muted small">
              –í—ã–±–µ—Ä–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±–ª–∏–∂–µ –∫ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏.
            </p>

            <div id="quizQuote" class="sutra-box quiz-quote">
              –ù–∞–∂–º–∏ ¬´–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å¬ª, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å.
            </div>
            <p id="quizQuestion" class="quiz-question-text"></p>
            <div id="quizOptions" class="quiz-options"></div>
            <div class="quiz-controls">
              <button id="newQuestionBtn" class="btn ghost small">‚ú® –ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
            </div>
            <div id="quizStatus" class="quiz-status"></div>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>

<!-- –°–∫—Ä–∏–ø—Ç –∞–Ω–∏–º–∞—Ü–∏–∏ –æ–±–ª–∞–∫–∞ —Ç–æ—á–µ–∫ / —Å–µ—Ä–¥–µ—Ü -->
<script>
(function () {
  const canvas = document.getElementById('heartwins');
  const ctx = canvas.getContext('2d');

  let width = window.innerWidth;
  let height = window.innerHeight;

  function resize() {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width * window.devicePixelRatio;
    canvas.height = height * window.devicePixelRatio;
    ctx.setTransform(window.devicePixelRatio, 0, 0, window.devicePixelRatio, 0, 0);
  }
  resize();
  window.addEventListener('resize', resize);

  function heartPointBase(t, scale, cx, cy) {
    let x = 16 * Math.pow(Math.sin(t), 3);
    let y = 13 * Math.cos(t)
          - 5 * Math.cos(2 * t)
          - 2 * Math.cos(3 * t)
          - Math.cos(4 * t);
    return {
      x: x * scale + cx,
      y: -y * scale + cy
    };
  }

  function heartPointDouble(t, scale, cx, cy, branch) {
    const p = heartPointBase(t, scale, cx, cy);
    if (branch === 0) return p;
    const reflectedY = 2 * cy - p.y;
    return { x: p.x, y: reflectedY + 12 * scale };
  }

  const particles = [];
  const PARTICLE_COUNT = 450;

  function createParticle() {
    return {
      t: Math.random() * Math.PI * 2,
      speed: 0.00007 + Math.random() * 0.00015,
      branch: Math.random() < 0.5 ? 0 : 1,
      size: 0.25 + Math.random() * 0.45,
      life: Math.random(),
      offsetX: (Math.random() - 0.5) * 0.8,
      offsetY: (Math.random() - 0.5) * 0.8,
      prevX: null,
      prevY: null
    };
  }

  for (let i = 0; i < PARTICLE_COUNT; i++) particles.push(createParticle());

  let lastTime = performance.now();
  let startTime = lastTime;

  const CYCLE_DURATION = 120000;
  const MAX_ANGULAR_SPEED_Y = 0.008;
  const MAX_ANGULAR_SPEED_X = 0.006;
  const MIN_SPEED_START = 0.4;
  const MIN_SPEED_END   = 0.02;

  let angleY = 0;
  let angleX = 0;

  function animate(now) {
    const dt = now - lastTime;
    lastTime = now;
    const cx = width / 2;
    const cy = height / 2;

    const R = 30;
    const scale = Math.min(width, height) * 0.9 / (2 * R);
    const Rpx = R * scale;

    const elapsed = (now - startTime) % CYCLE_DURATION;
    const phase = elapsed / CYCLE_DURATION;

    let speedFactor;
    if (phase <= 0.5) {
      speedFactor = MIN_SPEED_START + (1 - MIN_SPEED_START) * (phase / 0.5);
    } else {
      speedFactor = 1 - (1 - MIN_SPEED_END) * ((phase - 0.5) / 0.5);
    }

    const angularSpeedY = MAX_ANGULAR_SPEED_Y * speedFactor;
    const angularSpeedX = MAX_ANGULAR_SPEED_X * speedFactor;

    let trailAlpha;
    if (phase <= 0.5) {
      const u = phase / 0.5;
      trailAlpha = 0.018 - 0.01 * u;
    } else {
      const u = (phase - 0.5) / 0.5;
      trailAlpha = 0.008 + (0.8 - 0.008) * u;
    }

    ctx.fillStyle = `rgba(0,0,0,${trailAlpha})`;
    ctx.fillRect(0, 0, width, height);

    let dustFactor = phase <= 0.5 ? 1 : 1 - 0.8 * ((phase - 0.5) / 0.5);

    angleY += angularSpeedY * dt;
    angleX += angularSpeedX * dt;

    const cosY = Math.cos(angleY), sinY = Math.sin(angleY);
    const cosX = Math.cos(angleX), sinX = Math.sin(angleX);

    for (let p of particles) {
      p.t += p.speed * dt;
      if (p.t > Math.PI * 2) p.t -= Math.PI * 2;

      p.life += 0.0004 * dt;
      if (p.life > 1) Object.assign(p, createParticle());

      const base = heartPointDouble(p.t, scale, cx, cy, p.branch);
      let dx = (base.x + p.offsetX * scale) - cx;
      let dy = (base.y + p.offsetY * scale) - cy;
      let dz = 0;

      let x1 = dx * cosY + dz * sinY;
      let z1 = -dx * sinY + dz * cosY;

      let y2 = dy * cosX - z1 * sinX;
      let z2 = dy * sinX + z1 * cosX;

      let depth = (z2 + Rpx) / (2 * Rpx);
      depth = Math.max(0, Math.min(1, depth));

      const persp = 0.7 + 0.6 * depth;
      const sizeDepth = 0.5 + 0.9 * depth;
      const alphaDepth = 0.2 + 0.8 * depth;

      const xF = cx + x1 * persp;
      const yF = cy + y2 * persp;

      let r,g,b;
      if (p.branch === 0) {
        r = 255; g = 215; b = 0;      // –∑–æ–ª–æ—Ç–æ
      } else {
        r = 255; g = 150; b = 180;    // —Ä–æ–∑–æ–≤—ã–π
      }

      if (p.prevX != null) {
        ctx.beginPath();
        const tailA = 0.25 * alphaDepth * dustFactor;
        ctx.strokeStyle = `rgba(${r},${g},${b},${tailA})`;
        ctx.lineWidth = p.size * 2 * sizeDepth * dustFactor;
        ctx.moveTo(p.prevX, p.prevY);
        ctx.lineTo(xF, yF);
        ctx.stroke();
      }

      p.prevX = xF;
      p.prevY = yF;

      const alpha = (1 - p.life) * 0.9 * dustFactor * alphaDepth;
      const radius = p.size * sizeDepth * dustFactor;

      ctx.beginPath();
      ctx.fillStyle = `rgba(${r},${g},${b},${alpha})`;
      ctx.arc(xF, yF, radius, 0, Math.PI * 2);
      ctx.fill();
    }

    requestAnimationFrame(animate);
  }

  requestAnimationFrame(animate);
})();
</script>

<!-- –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
<script src="app.js"></script>
</body>
</html>
